{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\smita\\\\Desktop\\\\ReactWorks\\\\capstone\\\\client\\\\src\\\\components\\\\TimeEntries.js\";\nimport React, { Component } from 'react';\nimport TimeEntryForm from './TimeEntryForm';\nimport moment from 'moment';\nimport { getTimeEntries, saveTimeEntry, deleteTimeEntry } from '../services/TimeEntriesService';\nimport { toast } from \"react-toastify\";\nimport { getWorkOrders } from '../services/WorkOrderService'; //import Axios from './axios';\n\nclass TimeEntries extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      timeEntries: [],\n      workOrders: [],\n      dateArray: [],\n      weekArray: [],\n      startDate: \"2021-01-01\"\n    };\n\n    this.handleSave = async timeEntry => {\n      try {\n        const {\n          data: newTimeEntry\n        } = await saveTimeEntry(timeEntry);\n\n        if (timeEntry._id.startsWith(\"new\")) {\n          const timeEntries = this.state.timeEntries;\n          timeEntries.push({\n            _id: newTimeEntry._id,\n            date: timeEntry.date,\n            week: moment(timeEntry.date, \"MM-DD-YYYY\").week(),\n            workOrder: \" \",\n            hours: \" \"\n          });\n          this.setState({\n            timeEntries\n          });\n        }\n      } catch (ex) {\n        if (ex.response) console.log(\"ex.repsonse\", ex.response);\n      }\n    };\n\n    this.handleDelete = async timeEntry => {\n      const origionaltimeEntries = this.state.timeEntries;\n      const timeEntries = origionaltimeEntries.filter(m => m._id !== timeEntry._id);\n      this.setState({\n        timeEntries\n      });\n\n      try {\n        await deleteTimeEntry(timeEntry._id);\n      } catch (ex) {\n        console.log(\"HANDLE DELETE CATCH BLOCK\");\n        if (ex.response && ex.response.status === 404) toast.error(\"This post has already been deleted\");\n        this.setState({\n          timeEntries: origionaltimeEntries\n        });\n      }\n    };\n  }\n\n  async componentDidMount() {\n    const {\n      data: workOrders\n    } = await getWorkOrders();\n    const {\n      data\n    } = await getTimeEntries();\n    const timeEntries = data.map(o => ({\n      _id: o._id,\n      week: moment(moment(o.date).format(\"YYYY-MM-DD\")).week(),\n      date: moment(o.date).format(\"YYYY-MM-DD\"),\n      workOrderId: o.workOrderId,\n      hours: o.hours,\n      formType: \"data\"\n    })); // var dateArray = [];\n    // var weekArray = [];\n    // let prevWeekNumber = [];\n    // let weekNumber = \" \";\n    // var currentDate = moment(\n    //     moment(moment(), \"YYYY-MM-DD\").subtract(10, \"days\").format(\"YYYY-MM-DD\")\n    // );\n    // var startDate = moment(\n    //     moment(moment(), \"YYYY-MM-DD\").subtract(10, \"days\").format(\"YYYY-MM-DD\")\n    // );\n    // var stopDate = moment(\n    //     moment(moment(), \"YYYY-MM-DD\").add(10, \"days\").format(\"YYYY-MM-DD\")\n    // );\n    // var x = 0;\n    // let y = 0;\n    // while (currentDate <= stopDate) {\n    //     dateArray.push({\n    //         _id: x,\n    //         name: moment(currentDate).format(\"YYYY-MM-DD\"),\n    //     });\n    //     currentDate = moment(currentDate).add(1, \"days\");\n    //     x = x + 1;\n    //     weekNumber = moment(currentDate, \"YYYY-MM-DD\").week();\n    //     if (weekNumber !== prevWeekNumber) {\n    //         weekArray.push({\n    //             _id: y,\n    //             name: weekNumber,\n    //         });\n    //         prevWeekNumber = weekNumber;\n    //         y = y +1;\n    //     }\n    // }\n    //\n    // this.setState({ timeEntries, workOrders, dateArray, weekArray, startDate });\n\n    this.setState({\n      timeEntries,\n      workOrders\n    });\n  }\n\n  render() {\n    const {\n      timeEntries\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }\n    }, \" \", timeEntries.map(item => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: item._id,\n        className: \"list-inline-item list-group-item-info\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 32\n        }\n      }, /*#__PURE__*/React.createElement(TimeEntryForm, {\n        timeEntry: item // timeEntries={timeEntries}\n        ,\n        onDelete: this.handleDelete,\n        onSave: this.handleSave,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 25\n        }\n      }));\n    })));\n  }\n\n}\n\nexport default TimeEntries;","map":{"version":3,"sources":["C:/Users/smita/Desktop/ReactWorks/capstone/client/src/components/TimeEntries.js"],"names":["React","Component","TimeEntryForm","moment","getTimeEntries","saveTimeEntry","deleteTimeEntry","toast","getWorkOrders","TimeEntries","state","timeEntries","workOrders","dateArray","weekArray","startDate","handleSave","timeEntry","data","newTimeEntry","_id","startsWith","push","date","week","workOrder","hours","setState","ex","response","console","log","handleDelete","origionaltimeEntries","filter","m","status","error","componentDidMount","map","o","format","workOrderId","formType","render","item"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport TimeEntryForm from './TimeEntryForm';\r\nimport moment from 'moment';\r\nimport {getTimeEntries,  saveTimeEntry, deleteTimeEntry}  from '../services/TimeEntriesService'\r\nimport { toast } from \"react-toastify\";\r\n\r\nimport { getWorkOrders} from '../services/WorkOrderService'\r\n\r\n//import Axios from './axios';\r\n\r\nclass TimeEntries extends Component {\r\n\r\n    state = {\r\n        timeEntries: [],\r\n        workOrders: [],\r\n        dateArray: [],\r\n        weekArray: [],\r\n        startDate: \"2021-01-01\"\r\n        \r\n    };\r\n    \r\n    \r\n    \r\n    async componentDidMount() {\r\n        const  { data:workOrders }  =  await getWorkOrders();\r\n        const { data } = await getTimeEntries();\r\n        \r\n        const timeEntries = data.map(o=>({\r\n            _id : o._id,\r\n            week: moment(moment(o.date).format(\"YYYY-MM-DD\")).week(),\r\n            date: moment(o.date).format(\"YYYY-MM-DD\"),\r\n            workOrderId: o.workOrderId,\r\n            hours: o.hours,\r\n            formType: \"data\"\r\n        }))\r\n       \r\n        \r\n        // var dateArray = [];\r\n        // var weekArray = [];\r\n        // let prevWeekNumber = [];\r\n        // let weekNumber = \" \";\r\n\r\n        // var currentDate = moment(\r\n        //     moment(moment(), \"YYYY-MM-DD\").subtract(10, \"days\").format(\"YYYY-MM-DD\")\r\n        // );\r\n\r\n        // var startDate = moment(\r\n        //     moment(moment(), \"YYYY-MM-DD\").subtract(10, \"days\").format(\"YYYY-MM-DD\")\r\n        // );\r\n\r\n        // var stopDate = moment(\r\n        //     moment(moment(), \"YYYY-MM-DD\").add(10, \"days\").format(\"YYYY-MM-DD\")\r\n        // );\r\n\r\n        // var x = 0;\r\n        // let y = 0;\r\n\r\n        // while (currentDate <= stopDate) {\r\n        //     dateArray.push({\r\n        //         _id: x,\r\n        //         name: moment(currentDate).format(\"YYYY-MM-DD\"),\r\n        //     });\r\n        //     currentDate = moment(currentDate).add(1, \"days\");\r\n        //     x = x + 1;\r\n        //     weekNumber = moment(currentDate, \"YYYY-MM-DD\").week();\r\n\r\n        //     if (weekNumber !== prevWeekNumber) {\r\n        //         weekArray.push({\r\n        //             _id: y,\r\n        //             name: weekNumber,\r\n        //         });\r\n        //         prevWeekNumber = weekNumber;\r\n        //         y = y +1;\r\n        //     }\r\n        // }\r\n        //\r\n        // this.setState({ timeEntries, workOrders, dateArray, weekArray, startDate });\r\n        this.setState({timeEntries, workOrders})\r\n    }\r\n    \r\n    \r\n\r\n    handleSave =  async (timeEntry) => {\r\n        \r\n        try {\r\n            const { data: newTimeEntry } = await saveTimeEntry(timeEntry);\r\n      \r\n            if (timeEntry._id.startsWith(\"new\")) {\r\n                const timeEntries = this.state.timeEntries;\r\n             \r\n      \r\n              timeEntries.push({\r\n                _id: newTimeEntry._id,\r\n                date: timeEntry.date,\r\n                week: moment(timeEntry.date, \"MM-DD-YYYY\").week(),\r\n                workOrder: \" \",\r\n                hours: \" \",\r\n              });\r\n      \r\n              \r\n              this.setState({ timeEntries });\r\n            }\r\n          } catch (ex) {\r\n            if (ex.response) console.log(\"ex.repsonse\", ex.response);\r\n          }\r\n    };\r\n    \r\n    handleDelete = async (timeEntry) => {\r\n        const origionaltimeEntries = this.state.timeEntries;\r\n        const timeEntries = origionaltimeEntries.filter(\r\n            (m) => m._id !== timeEntry._id\r\n        );\r\n        this.setState({ timeEntries });\r\n    \r\n        try {\r\n            \r\n            await deleteTimeEntry(timeEntry._id);\r\n        } catch (ex) {\r\n            console.log(\"HANDLE DELETE CATCH BLOCK\");\r\n            if (ex.response && ex.response.status === 404)\r\n                toast.error(\"This post has already been deleted\");\r\n            this.setState({ timeEntries: origionaltimeEntries });\r\n        }\r\n    };\r\n\r\n    render() {\r\n\r\n        const {timeEntries} = this.state\r\n\r\n        return (\r\n            <div>\r\n                <div> {timeEntries.map((item) => {\r\n                        return <div  key={item._id}\r\n                        className=\"list-inline-item list-group-item-info\">            \r\n                        <TimeEntryForm\r\n                            timeEntry={item}\r\n\r\n                            // timeEntries={timeEntries}\r\n                            onDelete={this.handleDelete}\r\n                            onSave={this.handleSave}\r\n                        />\r\n                        </div>\r\n                    })}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default TimeEntries;"]},"metadata":{},"sourceType":"module"}